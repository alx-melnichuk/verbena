<div class="ppi-panel">
  <div class="ppi-content ppi-over-auto global-scroll">
  
    <div class="ppi-title">{{ 'profile.title' | translate }}</div>

    <form [formGroup]="formGroup" novalidate>
          
      <div mr-tp-1 class="ppi-avatar">
        <app-field-file-upload hg-100 *ngIf="!addedLogoView"
          [maxFileSize]="maxFileSize"
          [validFileTypes]="validFileTypes"
          (addFile)="addFile($event)"
          (readFile)="readFile($event)">
        </app-field-file-upload>
        <div *ngIf="!!addedLogoView" class="ppi-avatar-image">
          <img class="ppi-avatar-view" [src]="addedLogoView" alt="logo unavailable">
          <button class="ppi-delete-logo" (click)="deleteFileLogo()">
            <span class="ppi-delete-box"></span>
          </button>
        </div>
      </div>

      <app-uniqueness-check mr-tp-1
        #uniquenessCheckNickname="appUniquenessCheck"
        [debounceDelay]="debounceDelay"
        [checkUniquenessFn]="checkUniquenessNickname">
        <app-field-nickname wd-100
          formControlName="nickname"
          [isRequired]="true"
          label="field-nickname.label"
          hint="field-nickname.nickname_hint"
          [errorMsg]="uniquenessCheckNickname.isUniquenessError ? 'Conflict.nickname_already_use' : undefined"
          (input)="updateErrMsg(); uniquenessCheckNickname.checkParameter(controls.nickname.value);">
        </app-field-nickname>
      </app-uniqueness-check>

      <app-uniqueness-check mr-tp-1_5
        #uniquenessCheckEmail="appUniquenessCheck"
        [debounceDelay]="debounceDelay"
        [checkUniquenessFn]="checkUniquenessEmail">
        <app-field-email wd-100 
          formControlName="email"
          [isRequired]="true"
          label="field-email.label"
          [errorMsg]="uniquenessCheckEmail.isUniquenessError ? 'Conflict.email_already_use' : undefined"
          (input)="updateErrMsg(); uniquenessCheckEmail.checkParameter(controls.email.value);">
        </app-field-email>
      </app-uniqueness-check>

      <app-field-password wd-100 mr-tp-0_5
        formControlName="password"
        [isRequired]="false"
        label="profile.new_password"
        hint="field-password.password_hint"
        (input)="updateErrMsg()">
      </app-field-password>

      <app-field-descript wd-100 mr-tp-1_5
        formControlName="descript"
        [isRequired]="false"
        label="stream_edit.descript">
      </app-field-descript>

    </form>

  </div>

  <div mr-tp-1 class="ppi-actions">

    <button mat-raised-button color="primary"
      [disabled]="formGroup.pristine || formGroup.invalid"
      (click)="saveProfile()">
      <span class="ppi-actions-label">
        <i class="ppi-save"></i>
        {{ 'profile.save' | translate }}
      </span>
    </button>
  
    <button mat-raised-button class="ppi-cancel"
      (click)="cancelProfile()">
      <span class="ppi-actions-label">
        {{ 'buttons.cancel' | translate }}
      </span>
    </button>

  </div>
</div>